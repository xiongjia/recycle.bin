%title Windows Automation (Last update: Tue Feb  5 19:18:10 CST 2014)
%toc

= MS Windows Automation API =
== MSAA and UIA ==
目前 MS Windows 提供了 MSAA 和 UIA :
# Microsoft Active Accessibility (*MSAA*)
 - 很早被引入，所以很多控件都支持。
 - 引入的最初目的是辅助特殊人群使用电脑，所以 Automation 的功能不强。
 - 可以通过，MSAA 提供的 COM Interface 。
 - 自定义的 UI Control 也需要要实现对应的 MSAA 接口。
# Microsoft UI Automation (*UIA*)
 - 可以通过 .Net Interface 访问。
 - MS 新的 UI Framework 基本都支持，比如 WPF, Windows Forms。
 - UIA 内部会使用 MSAA bridge 来访问兼容比较老的 UI Control。
 - 通过提供各种 UIA Pattern 的方式来方便 Test Automation 的访问，同样 UI Control 开发也只需要提供对应的实现。对于 UI 控件测试者和开发者都更友好、便利些。

==  Assistant Tools ==
有開源的工具和 MS 提供的工具。<br>
通過輔助工具可以幫助開發或這測試者查看、監視或者調用 UI Control 上的 UIA/MSAA 屬性和方法。

=== MS Tools ===
 時間推移，好幾個 MS 提供的工具都已經被放棄了。<br>
 比如很好用的 UISpy 被放棄了(可能性能差了點)。http://msdn.microsoft.com/en-us/library/ms727247.aspx 
 官方說法是: <br>
 |The UI Spy tool is obsolete and no longer available. Developers should use other tools such as Inspect.exe that are available in the Windows Software Development Kit (SDK). For more info, see Testing Tools.|
 
 現在 MS 提供的 Testing tools 能在 http://msdn.microsoft.com/en-us/library/dd373661.aspx 上找到詳細情況。<br>
 我自己保留了一份舊版本的 binary 在我的 DropBox 共享目錄裡:  
 [[https://www.dropbox.com/sh/8tpu53m88cskvmp/Zn1gWNfZ1C/dev-tools/ms.uia|ms.uia-tools in my DropBox]] <br>
| uispy.zip          | UISpy         |
| inspect.zip        | Inspect       |
| acc.explorer32.zip | AccExplorer32 |
| acc.event.zip      | AccEvent      |

=== Open source tools ===
 * UIA Verify - UI Automation Verify (UIA Verify) Test Automation Framework 
  # 可以在 http://uiautomationverify.codeplex.com/ 上找到代碼和 Release 的版本。
  # 功能類似於 MS 的 UISpy
 * AccChecker - UI Accessibility Checker
  # 可以在 http://acccheck.codeplex.com/ 上找到代碼和 Release 的版本。
  # 功能類似於 MS 的 AccExplorer

== SDK ==
- /* XXX pending  (￣o￣) . z Z　*/

== My practice ==
* ps.uia - https://github.com/xiongjia/ps.uia <br>
 在 Powershell 里调用 MS UIAutomation 接口。基本上就是用反射调用 .Net 对象。

== Resource ==
* Microsoft Windows UI Automation Blog
 - http://blogs.msdn.com/b/winuiautomation/
* Introduction to Microsoft Active Accessibility
 - http://www.codeproject.com/Articles/18290/Introduction-to-Microsoft-Active-Accessibility
* MSAA in Mozilla  Gecko  ( Firefox 提供的 MSAA 接口)
 - http://www.mozilla.org/access/windows/msaa-server 
 - http://www.mozilla.org/access/windows/at-apis 
* Windows Automation API SDK Tools 
 - http://blogs.msdn.com/b/winuiautomation/archive/2009/06/03/windows-automation-api-sdk-tools.aspx
 
